{"version":3,"sources":["../../../../assets/Script/assets/Script/gamemain.js"],"names":["config","require","gezi","mask","gamemain","cc","Class","extends","Component","properties","label","default","type","Label","showalertmsg","num","allpngs","Prefab","celltile","stars","Sprite","stopView","Node","fuHuo","stopV","stopButton","pjlView","openboxview","itemview","loseScoreLabel","GameOver","loseShareButtton","pjlShareButtton","musicBtn","helpview","pjlScoreLabel","effect","djitem","gameOut","friendIcon","stopViewBack","helpViewPre","bg","star","star1","restart","Button","score","point","maxphy_value","g_mask_samecnt","g_clickid","gamestate","gamestatetime","maxnum","lianjiNumber","g_gezi","g_mask","allitems","curtimeawaypre","isShowFIcon","recoverNumber","hadShowPjl","allOpenItems","produceItem","onLoad","string","i","geziNumber","node","cellt","instantiate","push","parent","position","p","tmp_g","getAllgz","tmp_m","getAllmask","tywx","publicwx","tex","Texture2D","self","on","event","active","mpos","touch","getLocation","touchEndCallback","x","y","prerandomnumber","initgame","showItem","fhbut","getComponent","fhcall","recoverGame","hycall","fhsbCallBack","errorcall","setShareGroupCall","setSuccessCall","setErrorCall","showPlayMethod","helpviewpre","destroy","helpviewscript","setCloseCall","showSubStopView","showAlert","visibleControllButton","console","log","itemIndex","allitem","length","item","itemsceipt","setData","setClickCall","data","id","getAllPathByitemValue","updateItemByData","dealAllItems","JSON","stringify","itmindex","tdata","storeAllItem","addRecoverNumber","checkFriendsScore","showTouchEveryTime","msg","getNumberOfRunningActions","stopAllActions","rc","move","moveBy","call","callFunc","seq","sequence","runAction","showTouchEffect","touchpos","showStopView","items","Util","getItemFromLocalStorage","undefined","parse","e","titemIndex","storitem","openitemIndex","topenitem","getData","produceItems","itemid","randomFrom","itemnum","lowerValue","upperValue","Math","floor","random","ctor","gameState","waitclick","usingitem","allcellids","resetAllMask","value","checkmaskbyid","minCanRemoveNumber","setnum","settoblock","block","effectid","effecttime","checkclick","posx","gezi_size","posy","update","dt","drawPhyPoint","tickmove","tickeffect","draw","Graphics","_updateSubDomainCanvas","sc","domove","move_time","baseScore","step","speed_keep","gezi_pitch","actiontime_keep","id_keep","id_dest","from","adjustmove","gameOverCallBack","pjlCallBack","dealDoMove","dodrop","dealLianJiLogic","maxScoreShow","playZhEff","refreshbymask","LOGD","bfound","j","dealLianJiNumber","lianjiEffects","sgood","cgood","showBox","hhgood","maxgood","setItemToLocalStorage","ctx","clear","starIndex","vis","gameover","closePjlView","getrandomnum","needcheck","changenumbymask","reset","checkDirPaths","bj","add","abs","tnum","parseInt","maxrnum","topid","tmpid","dis","adjustdrop","settoblockvalue","backFirstPage","wx","postMessage","method","director","loadScene","destroyFinish","backCall","showMinFriend","openDataContext","getOpenDataContext","sharedCanvas","canvas","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","lingQuBox","findata","itemdata","restartGame"],"mappings":"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","file":"gamemain.js","sourceRoot":"../../../../assets/Script","sourcesContent":["/*\n    游戏的逻辑UI\n    游戏的操作的主要逻辑在这个module里面编写\n    created by gyc on 2018-08-01.\n*/\n\n// 倒入游戏涉及到的module\nvar config = require(\"AddOneConfig\")\nvar gezi   = require(\"GeZi\")\nvar mask   = require(\"GeZiMask\")\n\n\nvar gamemain = cc.Class({\n    extends: cc.Component,\n    properties: {\n        label: {\n            default: null,\n            type: cc.Label\n        },\n        showalertmsg: {\n            default: null,\n            type: cc.Label\n        },\n        num: {\n            default: [],\n            type: cc.Label\n        },\n        allpngs: {\n            default: [],\n            type: cc.Prefab\n        },\n        celltile: {\n            default: null,\n            type: cc.Prefab\n        },\n        stars: {\n            default: [],\n            type: cc.Sprite\n        },\n        stopView: {\n            default: null,\n            type: cc.Node\n        },\n        fuHuo: {\n            default: null,\n            type: cc.Node\n        },\n        stopV: {\n            default: null,\n            type: cc.Node\n        },\n        stopButton: {\n            default: null,\n            type: cc.Node\n        },\n        pjlView: {\n            default: null,\n            type: cc.Node\n        },\n        openboxview: {\n            default: null,\n            type: cc.Node\n        },\n        itemview: {\n            default: null,\n            type: cc.Node\n        },\n        loseScoreLabel: {\n            default: null,\n            type: cc.Label\n        },\n        GameOver: {\n            default: null,\n            type: cc.Label\n        },\n        loseShareButtton:{\n            default: null,\n            type: cc.Node\n        },\n        pjlShareButtton:{\n            default: null,\n            type: cc.Node\n        },\n        musicBtn:{\n            default: null,\n            type: cc.Node\n        },\n        helpview:{\n            default: null,\n            type: cc.Node\n        },\n        pjlScoreLabel: {\n            default: null,\n            type: cc.Label\n        },\n        effect:{\n            default:null,\n            type: cc.Prefab,\n        },\n        djitem:{\n            default:null,\n            type: cc.Prefab,\n        },\n        gameOut:{\n            default:null,\n            type:cc.Sprite,\n        },\n        friendIcon:{\n            default:null,\n            type:cc.Sprite,\n        },\n        stopViewBack:{\n            default:null,\n            type:cc.Sprite,\n        },\n        helpViewPre:{\n            default: null,\n            type:cc.Prefab,\n        },\n        // 游戏的背景\n        bg:cc.Node, \n        // 点击+1的动画sprite        \n        star:cc.Sprite, \n        // 组合+1的动画sprite    \n        star1:cc.Sprite,    \n        // 重新开始的按钮\n        restart:cc.Button,  \n        // 当前玩家得分\n        score: 0,\n        // 玩家当前体力 默认为最大值\n        point:config.maxphy_value,   \n        // 当前点击的块ID\n        g_mask_samecnt:0,\n        //点击的格子ID\n        g_clickid:-1,\n        //游戏状态-无，等待点击，移动，下落等\n        gamestate:'null', \n        //游戏状态的计时\n        gamestatetime:0,\n        //当前最大值\n        maxnum:5, \n        //此次点击产生的连击数\n        lianjiNumber:1, \n        // 存放每个格子的数组\n        g_gezi:[],\n        // 存放每个mask的数组\n        g_mask:[],\n        // 玩家当前道具\n        allitems:[],\n        // 此时距离上次点击屏幕有多长时间\n        curtimeawaypre:10,\n        // 控制隐藏好友\n        isShowFIcon:false,\n        // 此局复活次数\n        recoverNumber:0,\n        // 此局是否展示过破纪录\n        hadShowPjl:false,\n        // 此局是否展示过破纪录\n        allOpenItems:[],\n        // 此次连接产生的道具\n        produceItem:null,\n   \n    },\n\n    /*\n        调用: 场景加载完成后的回调\n        功能: 场景加载完成后的一些UI逻辑处理\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n    onLoad: function () {\n        // 初始分数显示为0\n        this.label.string = this.score;\n        \n        // 循环生成初始游戏\n        for(var i=0;i<config.geziNumber;i++)\n        {\n            var node     = new cc.Node(\"node\");\n            var cellt = cc.instantiate(this.celltile);\n            this.allpngs.push(cellt);\n            cellt.parent = this.node;\n            cellt.position = cc.p(0,0);\n            node.position = cc.p(0,0);\n            node.parent   = this.node;\n            var tmp_g = new gezi(i,this);\n            this.getAllgz().push(tmp_g);\n            var tmp_m = new mask(i, this);\n            this.getAllmask().push(tmp_m);\n        }\n        if(tywx.publicwx){\n            this.tex = new cc.Texture2D();\n            // window.sharedCanvas.width = 311;\n            // window.sharedCanvas.height = 110;\n        }\n        var self = this;\n        // 游戏的点击逻辑\n        this.node.on('touchend', function ( event ) {\n            if(self.stopView.active == false){\n                var mpos = event.touch.getLocation();\n                self.touchEndCallback(mpos.x,mpos.y);\n            }\n        });\n        // 前一个产生的随机数\n        this.prerandomnumber = 0;\n        // 初始游戏\n        this.initgame();\n        //   // 游戏的点击逻辑\n        this.stopViewBack.node.on('touchstart', function ( event ) {\n            return true;\n        });\n\n        this.gameOut.node.on('touchstart', function ( event ) {\n            return true;\n        });\n\n\n        \n        // var effect = cc.instantiate(this.effect);\n        // this.node.parent.addChild(effect);\n        // effect.x = 140;\n        // effect.y = 90;\n        this.showItem();\n        // 设置复活按钮的点击回调\n        let fhbut = this.fuHuo.getComponent(\"ShareButton\");\n        if (fhbut){\n            var fhcall = function(){\n                self.recoverGame();\n            } \n            var hycall = function(){\n                self.fhsbCallBack();\n            } \n\n            var errorcall = function(){\n                self.fhsbCallBack();\n            } \n            // 设置分享到组的成功回调\n            fhbut.setShareGroupCall(fhcall);\n            // 设置分享到好友的回调\n            fhbut.setSuccessCall(hycall);\n            // 设置分享失败后的回调\n            fhbut.setErrorCall(hycall);\n        }\n       \n    },\n\n\n      /*\n        调用: 点击游戏帮助的时候调用\n        功能: 展示游戏玩法\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n\n    showPlayMethod:function(){\n         if(this.helpviewpre != null){\n            this.helpviewpre.destroy();\n            this.helpviewpre = null;\n         }\n         // 添加帮助界面\n         this.helpviewpre = cc.instantiate(this.helpViewPre);\n         this.helpviewpre.x = -360;\n         this.helpviewpre.y = -640;\n         this.helpviewscript = this.helpviewpre.getComponent(\"helpview\");\n         var self = this;\n         this.helpviewscript.setCloseCall(function(){\n             self.showSubStopView();\n             self.showPlayMethod();\n         });\n         this.helpviewpre.parent = this.helpview;\n         this.helpview.active = !this.helpview.active ? true : false;\n    },\n\n    // 复活调用\n    fhsbCallBack:function(){\n        this.showAlert(\"复活失败\");\n        this.visibleControllButton(false);\n        this.initgame();\n    },\n\n    // 显示当前的道具\n    showItem:function(){\n        console.log(\"当局 = \")\n        for(var itemIndex = 0; itemIndex < config.allitem.length; itemIndex ++){\n            var item = cc.instantiate(this.djitem);\n            let itemsceipt = item.getComponent(\"DjItem\");\n            itemsceipt.setData(config.allitem[itemIndex]);\n            item.parent = this.itemview;\n            var self = this;\n            itemsceipt.setClickCall(function(data){\n                // 判断道具数量足不足\n                if(data.num > 0){\n                     if(data.id == 4){\n                        self.recoverGame();\n                     }else{\n                        self.getAllPathByitemValue(data);\n                     }\n                     // 刷新道具显示数据\n                     data.num = data.num - 1;\n                     if(data.num < 0){\n                        data.num = 0;\n                     }\n                     self.updateItemByData(data);\n                }else{\n                    self.showAlert(\"道具数量不足！\");\n                }\n            });\n            item.x = 45 + (itemIndex * 75);\n            item.y = -30;\n            this.allOpenItems.push(item);\n        }\n        // 刷新道具显示\n        this.dealAllItems();\n    },\n    \n\n    // 更新某个道具\n    updateItemByData:function(data){\n        if(data != null){\n          console.log(\"当前更新的数据 = \"+JSON.stringify(data));\n          for(var itmindex = 0; itmindex < this.allitems.length; itmindex ++){\n              var tdata = this.allitems[itmindex];\n              if(tdata.id == data.id){\n                 tdata.num = data.num;\n                 this.allitems[itmindex] = tdata;\n                 this.storeAllItem();\n                 this.dealAllItems(this.allitems)\n                 break;\n              }\n          }\n        }\n    },\n    // 添加复活次数\n    addRecoverNumber: function(){\n        this.recoverNumber = this.recoverNumber + 1;\n    },\n\n    // 隔多久检查一下当前分数要超越的玩家\n    checkFriendsScore:function(){\n         \n    },\n\n    /*\n        调用: 一段时间没有点击屏幕后调用\n        功能: 提示玩家点击某个方块可以消除\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    showTouchEveryTime:function(){\n        \n    },\n    \n    showAlert: function(msg){\n        \n        if(msg != null && this.showalertmsg.node.getNumberOfRunningActions() == 0){\n           this.showalertmsg.node.stopAllActions(); \n           var self = this;\n           this.showalertmsg.node.active = true; \n           this.showalertmsg.string = msg;\n           var rc = function(){\n                self.showalertmsg.node.active = false;\n                self.showalertmsg.node.x = 360;\n                self.showalertmsg.node.y = 739;\n                // 通过 tag 停止一个动作\n                self.showalertmsg.node.stopAllActions();\n           }\n           var move = cc.moveBy(2,cc.p(0, 260));\n           \n           var call = cc.callFunc(rc);\n           var seq = cc.sequence(move, call);\n           this.showalertmsg.node.runAction(seq);\n        }\n       \n    },\n\n    /*\n        调用: 点击的时候调用\n        功能: 点击方块产生特效\n        参数: [\n            touchpos: 当前触摸点的位置 type:{}\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    showTouchEffect:function(touchpos){\n       \n    },\n\n    /*\n        调用: 点击停止按钮的时候调用\n        功能: 显示停止按钮控制的菜单\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    showStopView:function(){\n       this.stopView.active = !this.stopView.active ? true : false;\n       if(this.stopView.active == false){\n          this.stopV.active = false;\n          this.pjlView.active = false;\n          this.openboxview.active = false;\n       }\n    },\n\n    /*\n        调用: 点击停止按钮的时候调用\n        功能: 显示停止按钮控制的菜单\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n   showSubStopView:function(){\n       this.stopView.active = !this.stopView.active ? true : false;\n       this.stopV.active = !this.stopV.active ? true : false;\n   },\n\n    \n    /*\n        调用: 道具变化和游戏初始化的时候调用\n        功能: 刷新道具显示\n        参数: [\n            allitem: 给定的显示道具数据\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    dealAllItems:function(allitem){\n        // tywx.Util.setItemToLocalStorage(\"allitems\",JSON.stringify([{id:1, num:2}])); \n        var items = tywx.Util.getItemFromLocalStorage(\"allitems\", [])\n        console.log(\"处理的道具数据 = \"+items) \n       \n      \n        // 刷新道具显示\n         if(items != null && items != undefined && items != []){\n           try{\n              if(allitem){\n                this.allitems = allitem;\n              }else{\n                this.allitems = JSON.parse(items);\n              }\n              \n           }catch(e){\n              this.allitems = this.allitems; \n           }\n           for(var titemIndex = 0; titemIndex < this.allitems.length; titemIndex++){\n                 var storitem = this.allitems[titemIndex];\n                 console.log(titemIndex + \"道具数据 = \"+JSON.stringify(items)) \n                 for(var openitemIndex = 0; openitemIndex < this.allOpenItems.length; openitemIndex ++){\n                    var topenitem = this.allOpenItems[openitemIndex].getComponent(\"DjItem\");\n                    var tdata = topenitem.getData();\n                    if(tdata.id == storitem.id){\n                        tdata.num = storitem.num;\n                        topenitem.setData(tdata);\n                        break;\n                    }\n                  }\n             }  \n         }\n    },\n\n    /*\n        调用: 道具变化和游戏初始化的时候调用\n        功能: 刷新道具显示\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    produceItems:function(maxnum){\n       // 随机道具的ID\n       var itemid = this.randomFrom(1, config.allitem.length);\n       // 随机道具的数量\n       var itemnum =  this.randomFrom(1, maxnum);\n       this.produceItem = {id:itemid, num:itemnum};\n       console.log(\"当前产生的道具 \"+JSON.stringify(this.produceItem))\n       \n    },\n    \n    /*\n        调用: 产生随机数的地方调用\n        功能: 产生指定范围的随机数\n        参数: [\n            lowerValue: 范围的最小值\n            upperValue: 范围的最大值\n        ]\n        返回值:[\n            无\n        ]\n        思路: 通用方法\n    */\n    randomFrom:function(lowerValue,upperValue)\n    {\n        return Math.floor(Math.random() * (upperValue - lowerValue + 1) + lowerValue);\n    },\n\n \n\n\n    /*\n        调用: 系统new 的时候调用。\n        功能: 该类的构造函数 可用于自身变量的初始化\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n    ctor:function(){\n       \n    },\n    \n    /*\n        调用: 在GeZi, GeZiData和该类中都有调用\n        功能: 得到当前的格子容器\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 方便统一管理\n    */\n    getAllgz :function(){\n        return this.g_gezi;\n    },\n    \n    /*\n        调用: 在GeZi, GeZiData和该类中都有调用\n        功能: 得到当前的mask容器\n        参数: [\n            无\n        ]\n        返回值: [\n            无\n        ]\n        思路: 方便统一管理\n    */\n    getAllmask: function(){\n        return this.g_mask;\n    },\n    \n\n    // 给定一个值 根据这个值在格子中的数字进行和值运算 找出每个格子加上这个值是否可以连接\n    /*\n     \n    */\n\n    getAllPathByitemValue:function(data){\n        if(this.gamestate == config.gameState.waitclick){\n            this.gamestate = config.gameState.usingitem;\n            // 得出当前可连的所有路径\n            var allcellids = [];\n            for(var i = 0; i < config.geziNumber; i++){\n                this.resetAllMask();\n                this.getAllmask()[i].num = this.getAllmask()[i].num + data.value;\n                this.checkmaskbyid(i, 0);\n                if(this.g_mask_samecnt >= config.minCanRemoveNumber){\n                    allcellids[allcellids.length] = i;\n                }\n                \n            }\n            this.resetAllMask();\n            //  console.log(\"当前值可消除的mask\"+JSON.stringify(allcellids));\n            if(allcellids.length > 0){\n                let i = allcellids[0];\n                var  num = this.getAllgz()[i].num + data.value;\n                this.getAllgz()[i].setnum(num);\n                this.getAllgz()[i].settoblock();\n                this.getAllgz()[i].block.effectid   = 0;\n                this.getAllgz()[i].block.effecttime = 0.5;\n                if(num > this.maxnum){\n                this.maxnum = num;\n                }\n                this.g_clickid =  allcellids[0];\n                this.gamestate = config.gameState.checkclick;\n            }else{\n                this.gamestate = config.gameState.checkclick;\n                this.showAlert(\"当前道具用了也没用,请还其他道具\")\n            }\n        }\n    },\n    \n\n    /*\n        调用: 当点击屏幕的时候调用\n        功能: 处理点击屏幕产生的逻辑(主要是判断出当前点击的位置在某个格子上)\n        参数: [\n            x: 点击的X坐标\n            y: 点击点的Y坐标\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏和玩家的交互接口\n    */\n    touchEndCallback:function(x,y){\n        // 判断当前的游戏状态是否为等待点击状态\n        if(this.gamestate == config.gameState.waitclick){\n            for(var i = 0; i < config.geziNumber; i++){\n                // 根据点击的点 来判断当前点击在那个格子上面\n                if( x > this.getAllgz()[i].posx && x  < (this.getAllgz()[i].posx + config.gezi_size) &&\n                    y > this.getAllgz()[i].posy && y  < (this.getAllgz()[i].posy + config.gezi_size)){\n                    var  num = this.getAllgz()[i].num + 1;\n                    this.getAllgz()[i].setnum(num);\n                    this.getAllgz()[i].settoblock();\n                    this.getAllgz()[i].block.effectid   = 0;\n                    this.getAllgz()[i].block.effecttime = 0.5;\n                    if(num > this.maxnum){\n                       this.maxnum = num;\n                    }\n                    // 记录下当前点击的格子 和切换当前的游戏状态为检查点击状态\n                    this.g_clickid  = i;\n                    this.gamestate  = config.gameState.checkclick;\n                    // 在方块上产生点击特效\n                    var mpos = {};\n                    this.showTouchEffect(mpos);\n                    // 终止此次点击的循环处理\n                    break;\n                }\n            }\n        }\n    },\n \n    /*\n        调用: 每一帧都调用\n        功能: 游戏的主体逻辑都在这个方法里面\n        参数: [\n            dt: 系统渲染的时间\n        ]\n        返回值:[\n            无\n        ]\n        思路: 每一帧都调用适合处理这个游戏的玩法和操作  \n    */\n    update: function (dt) {\n        this.label.string = this.score;\n        \n        this.drawPhyPoint();\n        if(this.getAllgz().length == config.geziNumber) {\n            for (var i = 0; i < config.geziNumber; i++) {\n                this.getAllgz()[i].block.tickmove(dt);\n                this.getAllgz()[i].block.tickeffect(dt,this.star,this.star1);\n                this.getAllgz()[i].draw(this.bg.getComponent(cc.Graphics),this.allpngs[i]);\n            }\n        }\n        if(this.isShowFIcon){\n           this._updateSubDomainCanvas();\n        }\n        switch (this.gamestate){\n            case config.gameState.checkclick:{ \n                this.resetAllMask();\n                var sc = this.getAllgz()[this.g_clickid].num;\n                this.lianjiNumber = 1;\n                this.checkmaskbyid(this.g_clickid, 0);\n                if (this.g_mask_samecnt >= config.minCanRemoveNumber) {\n                    this.gamestate = config.gameState.domove;\n                    this.gamestatetime = config.move_time;\n                    this.score += config.baseScore * (this.g_mask_samecnt - 1) * sc;\n                    for(var i = 0; i < config.geziNumber; i ++){\n                        // 判断是否已经标记 \n                        if(this.getAllmask()[i].step != 999 && this.getAllmask()[i].step != 0){\n                            this.getAllgz()[i].block.speed_keep = config.gezi_pitch * this.getAllmask()[i].step / config.move_time;\n                            this.getAllgz()[i].block.actiontime_keep = config.move_time / this.getAllmask()[i].step;\n                            this.getAllgz()[i].block.id_keep = i;\n                            this.getAllgz()[i].block.id_dest = this.getAllmask()[i].from;\n                            this.getAllgz()[i].block.adjustmove();\n                        }\n                    }\n                }else{\n                   \n                    this.point --;\n                    // 判断游戏是否结束\n                    if(this.point <= 0) {\n                       this.gameOverCallBack()\n                    }else{\n                       this.gamestate = config.gameState.waitclick;\n                    }\n                    if(this.hadShowPjl == false){\n                       this.pjlCallBack();\n                    }\n                }\n                break;\n            }\n            //格子组合移动，进入掉落状态\n            case config.gameState.domove:{\n                this.gamestatetime -= dt;\n                if(this.gamestatetime <= 0){\n                   this.dealDoMove()\n                }\n                break;\n            }\n            //格子掉落完，进入再次检查合并状态，或者等待点击状态\n            case config.gameState.dodrop:\n            {\n                this.gamestatetime -= dt;\n                if(this.gamestatetime <= 0){\n                   this.dealLianJiLogic();\n                }\n                break;\n            }\n        }\n    },\n    \n    /*\n        调用: 处于移动状态的时候调用\n        功能: 移动的逻辑处理\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏和玩家的交互的表现\n    */\n    dealDoMove(){\n         this.star.node.active = false;\n         this.gamestate        = config.gameState.dodrop;\n         this.gamestatetime    = config.move_time;\n         var num = this.getAllgz()[this.g_clickid].num + 1;\n         this.getAllgz()[this.g_clickid].setnum(num);\n         this.getAllgz()[this.g_clickid].settoblock();\n         this.getAllgz()[this.g_clickid].block.effectid = 1;\n         this.getAllgz()[this.g_clickid].block.effecttime = 0.5;\n         if(num > this.maxnum){\n             this.maxnum = num;\n             this.maxScoreShow();\n         }\n         if(this.allpngs[this.g_clickid]){\n            this.allpngs[this.g_clickid].getComponent(\"celltile\").playZhEff();\n         }\n         console.log(\"Hellocd\");\n         this.refreshbymask();\n    },\n\n\n    /*\n        调用: 产生最大数字的时候调用\n        功能: 产生最大数字的逻辑处理\n        参数: [\n            无\n        ]\n        返回值: [\n            无\n        ]\n        思路: 逻辑需要\n    */\n    maxScoreShow: function(){\n        tywx.LOGD(\"产生最大数字\",this.maxnum);\n    },\n   \n    /*\n        调用: 游戏处于掉落状态的时候调用\n        功能: 掉落状态的逻辑处理\n        参数: [\n            无\n        ]\n        返回值: [\n            无\n        ]\n        思路: 游戏和玩家的交互的表现\n    */\n    dealLianJiLogic: function(){\n        var bfound = false;\n        for(var j = 0; j < config.geziNumber; j++){\n            this.resetAllMask();\n            var sc =this.getAllgz()[j].num;\n            this.checkmaskbyid(j, 0);\n            if (this.g_mask_samecnt >= 3) {\n                this.gamestate = config.gameState.domove;\n                this.gamestatetime = config.move_time;\n                this.lianjiNumber ++;\n                this.score += config.baseScore * sc * (this.g_mask_samecnt - 1);\n                for(var i = 0; i < 25; i++){\n                    if(this.getAllmask()[i].step != 999 && this.getAllmask()[i].step != 0){\n                       this.getAllgz()[i].block.speed_keep = config.gezi_pitch * this.getAllmask()[i].step/config.move_time;\n                       this.getAllgz()[i].block.actiontime_keep = config.move_time / this.getAllmask()[i].step;\n                       this.getAllgz()[i].block.id_keep = i;\n                       this.getAllgz()[i].block.id_dest = this.getAllmask()[i].from;\n                       this.getAllgz()[i].block.adjustmove();\n                    }\n                } \n                bfound=true;\n                this.g_clickid = j;\n                if(this.point<5)\n                   this.point++;\n                   break;\n                }\n            }\n\n            if(bfound == false){\n               this.gamestate = config.gameState.waitclick;\n               // 判断连接数的大小 如果连接数大于不同的值则产生不同的效果\n               this.dealLianJiNumber();\n            }\n    },\n    \n    /*\n        调用: 当玩家点击一次交付结束后调用\n        功能: 展示相关的特效UI\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 多元化游戏元素\n    */\n    dealLianJiNumber: function(){\n           if(this.lianjiNumber > config.lianjiEffects.sgood && this.lianjiNumber <= config.lianjiEffects.cgood ) {\n              this.showBox(1);  \n           }else if(this.lianjiNumber > config.lianjiEffects.cgood && this.lianjiNumber <= config.lianjiEffects.hhgood ) {\n              this.showBox(2); \n           }else if(this.lianjiNumber > config.lianjiEffects.hhgood && this.lianjiNumber <= config.lianjiEffects.maxgood ) {\n              this.showBox(3);  \n           }else if(this.lianjiNumber > config.lianjiEffects.maxgood) {\n              this.showBox(5);  \n           }\n        //    else if(this.lianjiNumber > 1) {\n        //       this.showBox(1);  \n        //    }\n    },\n\n    /*\n            调用: 当宝箱数据有更新的时候存储\n            功能: 存储宝箱数据到本地\n            参数: [\n                无\n            ]\n            返回值:[\n                无\n            ]\n            思路: 游戏需求\n     */\n     storeAllItem: function(){\n        console.log(\"当前存储的数据 = \"+JSON.stringify(this.allitems))\n        if(this.allitems){\n           tywx.Util.setItemToLocalStorage(\"allitems\",JSON.stringify(this.allitems));\n        }\n     },\n\n\n    /*\n        调用: 1: 游戏初始的时候调用，2: 每次点击的时候没有连接的时候调用，3: 重新开始游戏的时候调用。\n        功能: 展示相关的特效UI\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏元素需求\n    */\n    drawPhyPoint:function(){\n        var ctx = this.bg.getComponent(cc.Graphics);\n        ctx.clear();\n        // for(var i = 0;i< this.point; i++){\n        //     let color = config.showphy_pros.colors[i];\n        //     ctx.fillColor = cc.color(color[0],color[1],color[2]);\n        //     var x = (config.swidth - ((config.showphy_pros.phy_num - (config.maxphy_value - this.point)) * config.gezi_pitch)) / 2 + (config.showphy_pros.width + 10) * i;\n        //     var y = 980;\n        //     var w = config.showphy_pros.width;\n        //     var h = config.showphy_pros.height;\n        //     ctx.roundRect(x,y,w,h,config.showphy_pros.radius);\n        //     ctx.fill();\n        // }\n         for(var starIndex = 0; starIndex < 5; starIndex ++){\n            if(this.point >= starIndex + 1){\n               this.stars[starIndex].node.active = true;\n            }else{\n               this.stars[starIndex].node.active = false;\n            }\n        }\n    },\n    \n    /*\n        调用: 1: 游戏重新开始的时候需要隐藏，2: 游戏结束的时候需要显示\n        功能: gameOver和restart按钮的显示隐藏控制\n        参数: [\n            vis: false: 隐藏元素，true: 显示元素\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    visibleControllButton:function(vis){\n        this.gameOut.node.active = vis;\n    },\n\n    /*\n        调用: 1: 游戏结束的时候需要显示\n        功能: 游戏结束的逻辑\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    gameOverCallBack:function(){\n        // 判断此次得分是否创纪录\n        this.gamestate = config.gameState.gameover;\n        this.visibleControllButton(true);\n        // 刷新当前的显示得分\n        this.loseScoreLabel.string = this.score;\n    },\n\n    /*\n        调用: 1: 刷新当前得分的时候\n        功能: 展示破纪录界面\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    pjlCallBack:function(){\n        // 判断此次得分是否创纪录\n        if(this.score > tywx.Util.getItemFromLocalStorage(\"maxscore\", 0)){\n            this.hadShowPjl = true;\n            this.visibleControllButton(false);\n            this.stopView.active = true;\n            this.pjlView.active = true;\n            // 刷新破纪录的显示\n            this.pjlScoreLabel.string = this.score;\n        }\n    },\n\n\n    /*\n        调用: 点击展示破纪录画面时候的关闭按钮调用\n        功能: 关闭破纪录界面\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    closePjlView:function(){\n        // 判断此次得分是否创纪录\n        this.showStopView();\n        this.pjlView.active = false;\n    },\n\n    /*\n        调用: 1: 游戏开始的时候调用 2: 游戏重新开始的时候调用\n        功能: 游戏初始化\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    initgame:function() {\n        this.score  = 0;\n        this.point  = config.maxphy_value;\n        this.maxnum = config.maxphy_value;\n        this.recoverNumber = 0;\n\n        for (var i = 0; i < config.geziNumber; i++) {\n            var num = this.getrandomnum();\n            this.getAllgz()[i].setnum(num);\n            this.getAllgz()[i].settoblock();\n        }\n\n        var needcheck = true;\n\n        while(needcheck == true) {\n            needcheck = false;\n            for (var i = 0; i < config.geziNumber; i++) {\n                this.resetAllMask();\n                this.checkmaskbyid(i, 0);\n                if (this.g_mask_samecnt >= 3) {\n                    this.changenumbymask();\n                    needcheck = true;\n                }\n            }\n        }\n\n        this.gamestate = config.gameState.waitclick;\n        this.visibleControllButton(false)\n    },\n   \n    /*\n        调用: 1: 游戏处于检查点击的时候调用 2: 游戏开始的时候调用 3: 处理格子连接的时候调用\n        功能: 重置棋盘mask，为重新探路做准备\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    resetAllMask:function(){\n        for(var i=0;i<config.geziNumber;i++){\n            this.getAllmask()[i].reset();\n        }\n        this.g_mask_samecnt = 1;\n    },\n    \n    \n     /*\n        调用: 1: 处理游戏点击的时候调用 2:游戏格子连接的时候调用\n        功能: 递归寻找给定ID的格子 并在mask数组里面进行标记\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要 通过mask标记来找出每次连接的格子\n    */\n    checkmaskbyid:function(id,step){\n        this.getAllmask()[id].step=step;\n        // 从左找\n        this.checkDirPaths(id, step,0, -1);\n        this.checkDirPaths(id, step,0, -5);\n        this.checkDirPaths(id, step,4, 1);\n        this.checkDirPaths(id, step,4, 5);\n    },\n    \n     /*\n        调用: 1: checkmaskbyid寻找可连的点\n        功能: 检查是否可以继续连接\n        参数: [\n            id: 每个格子的ID\n            step: 此次寻找的步数\n            bj: 寻找边界\n            add: 叠加数 上下加减5 左右加减1\n        ]\n        返回值:[\n           无\n        ]\n        思路: 根据递归寻找下一个点的连接情况\n    */\n    checkDirPaths: function(id, step, bj, add){\n        if(Math.abs(add) == 4 && this.getAllmask()[id] != null && this.getAllmask()[id].y == bj){\n           return false\n        }else if(Math.abs(add) == 1 && this.getAllmask()[id] != null && this.getAllmask()[id].x == bj){\n           return false\n        }\n        if(this.getAllmask()[id] == null || this.getAllmask()[id + add] == null){\n            return false;\n        }\n        if(this.getAllmask()[id + add].num != this.getAllmask()[id].num || this.getAllmask()[id + add].step <= step){\n           return false;\n        }\n\n        if(this.getAllmask()[id + add].step==999){\n            this.g_mask_samecnt++;\n        }\n\n        this.getAllmask()[id + add].step = step;\n        this.getAllmask()[id + add].from = id;\n        this.checkmaskbyid(id + add, step + 1, bj, add)\n    },\n\n\n     /*\n        调用: 游戏初始的时候调用\n        功能: 改变格子的数字 通过mask\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    changenumbymask:function(){\n        for(var i = 0;i < config.geziNumber; i++){\n            if(this.getAllmask()[i].step != 999 && this.getAllmask()[i].step != 0){\n                var num = this.getrandomnum();\n                this.getAllgz()[i].setnum(num);\n                this.getAllgz()[i].settoblock();\n            }\n        }\n    },\n   \n   /*\n        调用: 1, 游戏初始的时候调用 2, 改变格子的数字的时候调用\n        功能: 创建随机的新块 返回新快的显示\n        参数: [\n           无\n        ]\n        返回值:[\n           num: 返回格子的显示数组\n        ]\n        思路: 游戏逻辑需要\n    */\n    getrandomnum:function(){\n        var tnum = this.maxnum - 2;\n        if(tnum<5)\n            tnum = 5;\n\n        var num = parseInt(Math.random() * 10000) % tnum + 1;\n        // if(this.prerandomnumber == num){\n        //     return this.getrandomnum();\n        // }else{\n        //     this.prerandomnumber = num;\n        // }\n        return num;\n    },\n        /*\n        调用: 使用满血道具 或者分享游戏的时候调用\n        功能: 复活游戏\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    recoverGame: function(){\n        if(this.recoverNumber < config.maxrnum){\n            this.point = config.maxphy_value;\n            this.gamestate = config.gameState.waitclick;\n            this.addRecoverNumber();\n            this.visibleControllButton(false);\n        }else{\n            this.showAlert(\"复活次数已达\"+config.maxrnum+\"次，不能继续复活。\")\n            this.initgame();\n        }\n       \n    },\n    \n    /*\n        调用: 游戏处于移动状态的时候调用\n        功能: 创建新的棋盘，为掉落做准备\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    refreshbymask:function(){ \n        for(var i = 0;i < config.geziNumber;i++) {\n            if (this.getAllmask()[i].step != 999 && this.getAllmask()[i].step != 0) {\n                this.getAllmask()[i].from =- 1;\n                var topid = -1;\n                var tmpid = i + 5;\n                while(tmpid < config.geziNumber){\n                    if(this.getAllmask()[tmpid].step == 999 || this.getAllmask()[tmpid].step==0){\n                        topid = tmpid;\n                        break;\n                    }\n                    tmpid += 5;\n                }\n                if(topid != -1){\n                    var dis = this.getAllmask()[topid].y - this.getAllmask()[i].y;\n                    this.getAllgz()[i].block.posx        = this.getAllgz()[topid].posx;\n                    this.getAllgz()[i].block.posy        = this.getAllgz()[topid].posy;\n                    this.getAllgz()[i].block.id_keep     = topid;\n                    this.getAllgz()[i].block.id_dest     = i;\n                    this.getAllgz()[i].block.speed_keep  = (dis * config.gezi_pitch) / config.move_time;\n                    this.getAllgz()[i].block.adjustdrop();\n                    this.getAllgz()[topid].step = 888;\n                    var num = this.getrandomnum();\n                    // this.getAllgz()[i].setnum(this.getAllgz()[topid].num);\n                    this.getAllgz()[i].setnum(num);\n                    this.getAllgz()[i].settoblockvalue();\n                    this.getAllgz()[i].block.effectid       =  this.getAllgz()[topid].block.effectid;\n                    this.getAllgz()[i].block.effecttime     =  this.getAllgz()[topid].block.effecttime;\n                    this.getAllgz()[topid].block.effectid   =- 1;\n                    this.getAllgz()[topid].block.effecttime =  0;\n                }else{\n                    var dis = 5 - this.getAllmask()[i].y;\n                    this.getAllgz()[i].block.posx    = this.getAllgz()[i].posx;\n                    this.getAllgz()[i].block.posy    = this.getAllgz()[i].posy + dis * config.gezi_pitch;\n                    this.getAllgz()[i].block.id_keep = -1;\n                    this.getAllgz()[i].block.id_dest = i;\n                    this.getAllgz()[i].block.speed_keep = (dis * config.gezi_pitch) / config.move_time;\n                    this.getAllgz()[i].block.adjustdrop();\n                    var num = this.getrandomnum();\n                    this.getAllgz()[i].setnum(num);\n                    this.getAllgz()[i].settoblockvalue();\n                }\n            }\n        }\n    },\n    /*\n        调用: 点击返回首页的时候会调用\n        功能: 返回首页\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    backFirstPage:function(){\n        if(tywx.Util.getItemFromLocalStorage(\"maxscore\", 0) < this.score){\n           tywx.Util.setItemToLocalStorage(\"maxscore\",this.score); \n        }\n        if(tywx.publicwx){\n            wx.postMessage({\n                method: 4,\n                score:this.score,\n            });\n        }\n        cc.director.loadScene(\"gamestart\", this.destroyFinish);\n    },\n    \n    backCall:function(){\n    //    this.showMinFriend();\n        this.showAlert(\"测试提示信息\")\n        // this.getAllPathByitemValue({value:2});\n    },\n\n    showMinFriend:function(){\n        var self = this;\n        this.isShowFIcon = true;\n        wx.postMessage({\n            method: 5,\n            score:self.score,\n        });\n    },\n\n    // 刷新子域的纹理\n    _updateSubDomainCanvas: function() {\n            if (!this.tex || !tywx.publicwx) {\n                return;\n            }\n            var openDataContext = wx.getOpenDataContext();\n            var sharedCanvas = openDataContext.canvas;\n            this.tex.initWithElement(sharedCanvas);\n            this.tex.handleLoadedTexture();\n            this.friendIcon.spriteFrame = new cc.SpriteFrame(this.tex);\n     },\n   \n    /*\n        调用: 点击返回首页的时候会调用\n        功能: 清除当前的节点\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    destroyFinish:function(){\n        if(this.node){\n           this.node.destroy();\n        }\n    },\n\n    /*\n        调用: 点击免费领取宝箱的时候调用\n        功能: 领取道具\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    lingQuBox:function(){\n          \n       // 查看当前ID的道具玩家是否存在\n       if(this.produceItem != null){\n            if(this.allitems.length == 0){\n               this.allitems[0] = this.produceItem; \n            }else{\n                // console.log(\"领取时玩家的道具数据 = \"+JSON.stringify(this.allitems))\n                var findata = false;\n                for(var itemIndex= 0; itemIndex < this.allitems.length; itemIndex ++){\n                    var itemdata = this.allitems[itemIndex];\n                    // console.log(\"领取时玩家的道具数据 = \"+JSON.stringify(this.allitems))\n                    if(itemdata.id == this.produceItem.id){\n                       itemdata.num = itemdata.num + this.produceItem.num;\n                       findata = true;\n                       this.allitems[itemIndex] = itemdata; \n                       break;\n                    }\n                }\n                if(findata == false){\n                   this.allitems[this.allitems.length] = this.produceItem; \n                }\n            }\n            this.showAlert(\"领取成功\");\n            this.produceItem = null;\n       }\n      \n        this.storeAllItem();\n        this.dealAllItems(this.allitems);\n        this.openboxview.active = false;\n        this.showStopView();\n    },\n\n    /*\n        调用: 当条件达到某个值的时候显示领取宝箱\n        功能: 领取道具\n        参数: [\n           maxnum: 此次可以领取的道具的最大数量。\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    showBox:function(maxnum){\n        this.showStopView();\n        this.produceItems(maxnum)\n        this.openboxview.active = true;\n    },\n\n\n    restartGame:function(){\n        this.initgame();\n        this.showSubStopView();\n       \n    }\n\n});\n\n\n\n"]}