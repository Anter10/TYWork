{"version":3,"sources":["gamemain.js"],"names":["config","require","gezi","mask","gamemain","cc","Class","extends","Component","properties","label","default","type","Label","showalertmsg","num","allpngs","Prefab","celltile","stars","Sprite","stopView","Node","stopV","stopButton","pjlView","openboxview","itemview","loseScoreLabel","GameOver","loseShareButtton","pjlShareButtton","musicBtn","pjlScoreLabel","effect","djitem","gameOut","friendIcon","stopViewBack","bg","star","star1","restart","Button","score","point","maxphy_value","g_mask_samecnt","g_clickid","gamestate","gamestatetime","maxnum","lianjiNumber","g_gezi","g_mask","allitems","curtimeawaypre","isShowFIcon","recoverNumber","hadShowPjl","allItems","onLoad","string","i","geziNumber","node","cellt","instantiate","push","parent","position","p","tmp_g","getAllgz","tmp_m","getAllmask","tywx","publicwx","tex","Texture2D","self","on","event","active","mpos","touch","getLocation","touchEndCallback","x","y","prerandomnumber","initgame","showItem","console","log","itemIndex","allitem","length","item","itemsceipt","getComponent","setData","setPreParent","setClickCall","getAllPathByitemValue","addRecoverNumber","checkFriendsScore","showTouchEveryTime","showAlert","msg","rc","stopAllActions","move","moveBy","call","callFunc","seq","sequence","runAction","showTouchEffect","touchpos","showStopView","showSubStopView","dealAllItems","JSON","parse","ywx","Util","getItemFromLocalStorage","LOGD","ctor","data","gameState","waitclick","usingitem","allcellids","resetAllMask","value","checkmaskbyid","minCanRemoveNumber","setnum","settoblock","block","effectid","effecttime","checkclick","posx","gezi_size","posy","update","dt","drawPhyPoint","tickmove","tickeffect","draw","Graphics","_updateSubDomainCanvas","sc","domove","move_time","baseScore","step","speed_keep","gezi_pitch","actiontime_keep","id_keep","id_dest","from","adjustmove","gameOverCallBack","pjlCallBack","dealDoMove","dodrop","dealLianJiLogic","maxScoreShow","refreshbymask","bfound","j","dealLianJiNumber","lianjiEffects","sgood","cgood","showBox","hhgood","maxgood","storeAllItem","setItemToLocalStorage","ctx","clear","starIndex","visibleControllButton","vis","gameover","closePjlView","getrandomnum","needcheck","changenumbymask","reset","id","checkDirPaths","bj","add","Math","abs","tnum","parseInt","random","recoverGame","maxrnum","topid","tmpid","dis","adjustdrop","settoblockvalue","backFirstPage","wx","postMessage","method","director","loadScene","destroyFinish","backCall","showMinFriend","openDataContext","getOpenDataContext","sharedCanvas","canvas","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","destroy","lingQuBox","restartGame"],"mappings":"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","file":"gamemain.js","sourceRoot":"../../../../assets/Script","sourcesContent":["/*\n    游戏的逻辑UI\n    游戏的操作的主要逻辑在这个module里面编写\n    created by gyc on 2018-08-01.\n*/\n\n// 倒入游戏涉及到的module\nvar config = require(\"AddOneConfig\")\nvar gezi   = require(\"GeZi\")\nvar mask   = require(\"GeZiMask\")\n\n\nvar gamemain = cc.Class({\n    extends: cc.Component,\n    properties: {\n        label: {\n            default: null,\n            type: cc.Label\n        },\n        showalertmsg: {\n            default: null,\n            type: cc.Label\n        },\n        num: {\n            default: [],\n            type: cc.Label\n        },\n        allpngs: {\n            default: [],\n            type: cc.Prefab\n        },\n        celltile: {\n            default: null,\n            type: cc.Prefab\n        },\n        stars: {\n            default: [],\n            type: cc.Sprite\n        },\n        stopView: {\n            default: null,\n            type: cc.Node\n        },\n        stopV: {\n            default: null,\n            type: cc.Node\n        },\n        stopButton: {\n            default: null,\n            type: cc.Node\n        },\n        pjlView: {\n            default: null,\n            type: cc.Node\n        },\n        openboxview: {\n            default: null,\n            type: cc.Node\n        },\n        itemview: {\n            default: null,\n            type: cc.Node\n        },\n        loseScoreLabel: {\n            default: null,\n            type: cc.Label\n        },\n        GameOver: {\n            default: null,\n            type: cc.Label\n        },\n        loseShareButtton:{\n            default: null,\n            type: cc.Node\n        },\n        pjlShareButtton:{\n            default: null,\n            type: cc.Node\n        },\n        musicBtn:{\n            default: null,\n            type: cc.Node\n        },\n        pjlScoreLabel: {\n            default: null,\n            type: cc.Label\n        },\n        effect:{\n            default:null,\n            type: cc.Prefab,\n        },\n        djitem:{\n            default:null,\n            type: cc.Prefab,\n        },\n        gameOut:{\n            default:null,\n            type:cc.Sprite,\n        },\n        friendIcon:{\n            default:null,\n            type:cc.Sprite,\n        },\n        stopViewBack:{\n            default:null,\n            type:cc.Sprite,\n        },\n       \n        // 游戏的背景\n        bg:cc.Node, \n        // 点击+1的动画sprite        \n        star:cc.Sprite, \n        // 组合+1的动画sprite    \n        star1:cc.Sprite,    \n        // 重新开始的按钮\n        restart:cc.Button,  \n        // 当前玩家得分\n        score: 0,\n        // 玩家当前体力 默认为最大值\n        point:config.maxphy_value,   \n        // 当前点击的块ID\n        g_mask_samecnt:0,\n        //点击的格子ID\n        g_clickid:-1,\n        //游戏状态-无，等待点击，移动，下落等\n        gamestate:'null', \n        //游戏状态的计时\n        gamestatetime:0,\n        //当前最大值\n        maxnum:5, \n        //此次点击产生的连击数\n        lianjiNumber:1, \n        // 存放每个格子的数组\n        g_gezi:[],\n        // 存放每个mask的数组\n        g_mask:[],\n        // 玩家当前道具\n        allitems:[],\n        // 此时距离上次点击屏幕有多长时间\n        curtimeawaypre:10,\n        // 控制隐藏好友\n        isShowFIcon:false,\n        // 此局复活次数\n        recoverNumber:0,\n        // 此局是否展示过破纪录\n        hadShowPjl:false,\n        // 此局是否展示过破纪录\n        allItems:[],\n    },\n\n    /*\n        调用: 场景加载完成后的回调\n        功能: 场景加载完成后的一些UI逻辑处理\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n    onLoad: function () {\n        // 初始分数显示为0\n        this.label.string = this.score;\n        \n        // 循环生成初始游戏\n        for(var i=0;i<config.geziNumber;i++)\n        {\n            var node     = new cc.Node(\"node\");\n            var cellt = cc.instantiate(this.celltile);\n            this.allpngs.push(cellt);\n            cellt.parent = this.node;\n            cellt.position = cc.p(0,0);\n            node.position = cc.p(0,0);\n            node.parent   = this.node;\n            var tmp_g = new gezi(i,this);\n            this.getAllgz().push(tmp_g);\n            var tmp_m = new mask(i, this);\n            this.getAllmask().push(tmp_m);\n        }\n        if(tywx.publicwx){\n            this.tex = new cc.Texture2D();\n            // window.sharedCanvas.width = 311;\n            // window.sharedCanvas.height = 110;\n        }\n        var self = this;\n        // 游戏的点击逻辑\n        this.node.on('touchend', function ( event ) {\n            if(self.stopView.active == false){\n                var mpos = event.touch.getLocation();\n                self.touchEndCallback(mpos.x,mpos.y);\n            }\n        });\n        // 前一个产生的随机数\n        this.prerandomnumber = 0;\n        // 初始游戏\n        this.initgame();\n        //   // 游戏的点击逻辑\n        this.stopViewBack.node.on('touchstart', function ( event ) {\n            return true;\n        });\n        // var effect = cc.instantiate(this.effect);\n        // this.node.parent.addChild(effect);\n        // effect.x = 140;\n        // effect.y = 90;\n        this.showItem();\n    },\n\n    // 显示当前的道具\n    showItem:function(){\n        console.log(\"当局 = \")\n        for(var itemIndex = 0; itemIndex < config.allitem.length; itemIndex ++){\n            var item = cc.instantiate(this.djitem);\n            let itemsceipt = item.getComponent(\"DjItem\");\n            itemsceipt.setData(config.allitem[itemIndex]);\n            item.parent = this.itemview;\n            itemsceipt.setPreParent(this);\n            itemsceipt.setClickCall(this.getAllPathByitemValue);\n            item.x = 45 + (itemIndex * 75);\n            item.y = -30;\n            this.allItems.push(item);\n           \n        }\n    },\n    \n    // 添加复活次数\n    addRecoverNumber: function(){\n        this.recoverNumber = this.recoverNumber + 1;\n    },\n\n    // 隔多久检查一下当前分数要超越的玩家\n    checkFriendsScore:function(){\n         \n    },\n\n    /*\n        调用: 一段时间没有点击屏幕后调用\n        功能: 提示玩家点击某个方块可以消除\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    showTouchEveryTime:function(){\n        \n    },\n    \n    showAlert: function(msg){\n        \n        if(msg != null ){\n           var self = this;\n           this.showalertmsg.node.active = true; \n           this.showalertmsg.string = msg;\n           var rc = function(){\n                self.showalertmsg.node.active = false;\n                self.showalertmsg.node.x = 360;\n                self.showalertmsg.node.y = 739;\n                // 通过 tag 停止一个动作\n                self.showalertmsg.node.stopAllActions();\n           }\n           var move = cc.moveBy(2,cc.p(0, 260));\n           \n           var call = cc.callFunc(rc);\n           var seq = cc.sequence(move, call);\n           this.showalertmsg.node.runAction(seq);\n        }\n       \n    },\n\n    /*\n        调用: 点击的时候调用\n        功能: 点击方块产生特效\n        参数: [\n            touchpos: 当前触摸点的位置 type:{}\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    showTouchEffect:function(touchpos){\n       \n    },\n\n    /*\n        调用: 点击停止按钮的时候调用\n        功能: 显示停止按钮控制的菜单\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    showStopView:function(){\n       this.stopView.active = !this.stopView.active ? true : false;\n       if(this.stopView.active == false){\n          this.stopV.active = false;\n          this.pjlView.active = false;\n          this.openboxview.active = false;\n       }\n    },\n\n    /*\n        调用: 点击停止按钮的时候调用\n        功能: 显示停止按钮控制的菜单\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n   showSubStopView:function(){\n       this.stopView.active = !this.stopView.active ? true : false;\n       this.stopV.active = !this.stopV.active ? true : false;\n   },\n\n    \n    /*\n        调用: 道具变化和游戏初始化的时候调用\n        功能: 刷新道具显示\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    dealAllItems:function(){\n        let allitems = JSON.parse(ywx.Util.getItemFromLocalStorage(\"allitems\", \"[]\"));\n        tywx.LOGD(\"道具数据 = \",allitems);\n    },\n\n \n\n\n    /*\n        调用: 系统new 的时候调用。\n        功能: 该类的构造函数 可用于自身变量的初始化\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n    ctor:function(){\n       \n    },\n    \n    /*\n        调用: 在GeZi, GeZiData和该类中都有调用\n        功能: 得到当前的格子容器\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 方便统一管理\n    */\n    getAllgz :function(){\n        return this.g_gezi;\n    },\n    \n    /*\n        调用: 在GeZi, GeZiData和该类中都有调用\n        功能: 得到当前的mask容器\n        参数: [\n            无\n        ]\n        返回值: [\n            无\n        ]\n        思路: 方便统一管理\n    */\n    getAllmask: function(){\n        return this.g_mask;\n    },\n    \n\n    // 给定一个值 根据这个值在格子中的数字进行和值运算 找出每个格子加上这个值是否可以连接\n    /*\n     \n    */\n\n    getAllPathByitemValue:function(data){\n        if(this.gamestate == config.gameState.waitclick){\n            this.gamestate = config.gameState.usingitem;\n            // 得出当前可连的所有路径\n            var allcellids = [];\n            for(var i = 0; i < config.geziNumber; i++){\n                this.resetAllMask();\n                this.getAllmask()[i].num = this.getAllmask()[i].num + data.value;\n                this.checkmaskbyid(i, 0);\n                if(this.g_mask_samecnt >= config.minCanRemoveNumber){\n                    allcellids[allcellids.length] = i;\n                }\n                \n            }\n            this.resetAllMask();\n            //  console.log(\"当前值可消除的mask\"+JSON.stringify(allcellids));\n            if(allcellids.length > 0){\n                let i = allcellids[0];\n                var  num = this.getAllgz()[i].num + data.value;\n                this.getAllgz()[i].setnum(num);\n                this.getAllgz()[i].settoblock();\n                this.getAllgz()[i].block.effectid   = 0;\n                this.getAllgz()[i].block.effecttime = 0.5;\n                if(num > this.maxnum){\n                this.maxnum = num;\n                }\n                this.g_clickid =  allcellids[0];\n                this.gamestate = config.gameState.checkclick;\n            }else{\n                this.gamestate = config.gameState.checkclick;\n                this.showAlert(\"当前道具用了也没用,请还其他道具\")\n            }\n        }\n    },\n    \n\n    /*\n        调用: 当点击屏幕的时候调用\n        功能: 处理点击屏幕产生的逻辑(主要是判断出当前点击的位置在某个格子上)\n        参数: [\n            x: 点击的X坐标\n            y: 点击点的Y坐标\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏和玩家的交互接口\n    */\n    touchEndCallback:function(x,y){\n        // 判断当前的游戏状态是否为等待点击状态\n        if(this.gamestate == config.gameState.waitclick){\n            for(var i = 0; i < config.geziNumber; i++){\n                // 根据点击的点 来判断当前点击在那个格子上面\n                if( x > this.getAllgz()[i].posx && x  < (this.getAllgz()[i].posx + config.gezi_size) &&\n                    y > this.getAllgz()[i].posy && y  < (this.getAllgz()[i].posy + config.gezi_size)){\n                    var  num = this.getAllgz()[i].num + 1;\n                    this.getAllgz()[i].setnum(num);\n                    this.getAllgz()[i].settoblock();\n                    this.getAllgz()[i].block.effectid   = 0;\n                    this.getAllgz()[i].block.effecttime = 0.5;\n                    if(num > this.maxnum){\n                       this.maxnum = num;\n                    }\n                    // 记录下当前点击的格子 和切换当前的游戏状态为检查点击状态\n                    this.g_clickid  = i;\n                    this.gamestate  = config.gameState.checkclick;\n                    // 在方块上产生点击特效\n                    var mpos = {};\n                    this.showTouchEffect(mpos);\n                    // 终止此次点击的循环处理\n                    break;\n                }\n            }\n        }\n    },\n \n    /*\n        调用: 每一帧都调用\n        功能: 游戏的主体逻辑都在这个方法里面\n        参数: [\n            dt: 系统渲染的时间\n        ]\n        返回值:[\n            无\n        ]\n        思路: 每一帧都调用适合处理这个游戏的玩法和操作  \n    */\n    update: function (dt) {\n        this.label.string = this.score;\n        \n        this.drawPhyPoint();\n        if(this.getAllgz().length == config.geziNumber) {\n            for (var i = 0; i < config.geziNumber; i++) {\n                this.getAllgz()[i].block.tickmove(dt);\n                this.getAllgz()[i].block.tickeffect(dt,this.star,this.star1);\n                this.getAllgz()[i].draw(this.bg.getComponent(cc.Graphics),this.allpngs[i]);\n            }\n        }\n        if(this.isShowFIcon){\n           this._updateSubDomainCanvas();\n        }\n        switch (this.gamestate){\n            case config.gameState.checkclick:{ \n                this.resetAllMask();\n                var sc = this.getAllgz()[this.g_clickid].num;\n                this.lianjiNumber = 1;\n                this.checkmaskbyid(this.g_clickid, 0);\n                if (this.g_mask_samecnt >= config.minCanRemoveNumber) {\n                    this.gamestate = config.gameState.domove;\n                    this.gamestatetime = config.move_time;\n                    this.score += config.baseScore * (this.g_mask_samecnt - 1) * sc;\n                    for(var i = 0; i < config.geziNumber; i ++){\n                        // 判断是否已经标记 \n                        if(this.getAllmask()[i].step != 999 && this.getAllmask()[i].step != 0){\n                            this.getAllgz()[i].block.speed_keep = config.gezi_pitch * this.getAllmask()[i].step / config.move_time;\n                            this.getAllgz()[i].block.actiontime_keep = config.move_time / this.getAllmask()[i].step;\n                            this.getAllgz()[i].block.id_keep = i;\n                            this.getAllgz()[i].block.id_dest = this.getAllmask()[i].from;\n                            this.getAllgz()[i].block.adjustmove();\n                        }\n                    }\n                }else{\n                    this.gamestate = config.gameState.waitclick;\n                    this.point --;\n                    // 判断游戏是否结束\n                    if(this.point <= 0) {\n                       this.gameOverCallBack()\n                    }\n                    if(this.hadShowPjl == false){\n                       this.pjlCallBack();\n                    }\n                }\n                break;\n            }\n            //格子组合移动，进入掉落状态\n            case config.gameState.domove:{\n                this.gamestatetime -= dt;\n                if(this.gamestatetime <= 0){\n                   this.dealDoMove()\n                }\n                break;\n            }\n            //格子掉落完，进入再次检查合并状态，或者等待点击状态\n            case config.gameState.dodrop:\n            {\n                this.gamestatetime -= dt;\n                if(this.gamestatetime <= 0){\n                   this.dealLianJiLogic();\n                }\n                break;\n            }\n        }\n    },\n    \n    /*\n        调用: 处于移动状态的时候调用\n        功能: 移动的逻辑处理\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏和玩家的交互的表现\n    */\n    dealDoMove(){\n         this.star.node.active = false;\n         this.gamestate        = config.gameState.dodrop;\n         this.gamestatetime    = config.move_time;\n         var num = this.getAllgz()[this.g_clickid].num + 1;\n         this.getAllgz()[this.g_clickid].setnum(num);\n         this.getAllgz()[this.g_clickid].settoblock();\n         this.getAllgz()[this.g_clickid].block.effectid = 1;\n         this.getAllgz()[this.g_clickid].block.effecttime = 0.5;\n         if(num > this.maxnum){\n             this.maxnum = num;\n             this.maxScoreShow();\n         }\n         this.refreshbymask();\n    },\n\n\n    /*\n        调用: 产生最大数字的时候调用\n        功能: 产生最大数字的逻辑处理\n        参数: [\n            无\n        ]\n        返回值: [\n            无\n        ]\n        思路: 逻辑需要\n    */\n    maxScoreShow: function(){\n        tywx.LOGD(\"产生最大数字\",this.maxnum);\n    },\n   \n    /*\n        调用: 游戏处于掉落状态的时候调用\n        功能: 掉落状态的逻辑处理\n        参数: [\n            无\n        ]\n        返回值: [\n            无\n        ]\n        思路: 游戏和玩家的交互的表现\n    */\n    dealLianJiLogic: function(){\n        var bfound = false;\n        for(var j = 0; j < config.geziNumber; j++){\n            this.resetAllMask();\n            var sc =this.getAllgz()[j].num;\n            this.checkmaskbyid(j, 0);\n            if (this.g_mask_samecnt >= 3) {\n                this.gamestate = config.gameState.domove;\n                this.gamestatetime = config.move_time;\n                this.lianjiNumber ++;\n                this.score += config.baseScore * sc * (this.g_mask_samecnt - 1);\n                for(var i = 0; i < 25; i++){\n                    if(this.getAllmask()[i].step != 999 && this.getAllmask()[i].step != 0){\n                       this.getAllgz()[i].block.speed_keep = config.gezi_pitch * this.getAllmask()[i].step/config.move_time;\n                       this.getAllgz()[i].block.actiontime_keep = config.move_time / this.getAllmask()[i].step;\n                       this.getAllgz()[i].block.id_keep = i;\n                       this.getAllgz()[i].block.id_dest = this.getAllmask()[i].from;\n                       this.getAllgz()[i].block.adjustmove();\n                    }\n                } \n                bfound=true;\n                this.g_clickid = j;\n                if(this.point<5)\n                   this.point++;\n                   break;\n                }\n            }\n\n            if(bfound == false){\n               this.gamestate = config.gameState.waitclick;\n               // 判断连接数的大小 如果连接数大于不同的值则产生不同的效果\n               this.dealLianJiNumber();\n            }\n    },\n    \n    /*\n        调用: 当玩家点击一次交付结束后调用\n        功能: 展示相关的特效UI\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 多元化游戏元素\n    */\n    dealLianJiNumber: function(){\n           if(this.lianjiNumber > config.lianjiEffects.sgood && this.lianjiNumber < config.lianjiEffects.cgood ) {\n              this.showBox();  \n           }else if(this.lianjiNumber > config.lianjiEffects.cgood && this.lianjiNumber < config.lianjiEffects.hhgood ) {\n              this.showBox(); \n           }else if(this.lianjiNumber > config.lianjiEffects.hhgood && this.lianjiNumber < config.lianjiEffects.maxgood ) {\n              this.showBox();  \n           } \n           // 展示游戏宝箱\n           //    \n           \n    },\n\n    /*\n            调用: 当宝箱数据有更新的时候存储\n            功能: 存储宝箱数据到本地\n            参数: [\n                无\n            ]\n            返回值:[\n                无\n            ]\n            思路: 游戏需求\n     */\n     storeAllItem: function(){\n        if(this.allitems){\n            tywx.Util.setItemToLocalStorage(\"allitems\",this.allitems);\n        }\n     },\n\n\n    /*\n        调用: 1: 游戏初始的时候调用，2: 每次点击的时候没有连接的时候调用，3: 重新开始游戏的时候调用。\n        功能: 展示相关的特效UI\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏元素需求\n    */\n    drawPhyPoint:function(){\n        var ctx = this.bg.getComponent(cc.Graphics);\n        ctx.clear();\n        // for(var i = 0;i< this.point; i++){\n        //     let color = config.showphy_pros.colors[i];\n        //     ctx.fillColor = cc.color(color[0],color[1],color[2]);\n        //     var x = (config.swidth - ((config.showphy_pros.phy_num - (config.maxphy_value - this.point)) * config.gezi_pitch)) / 2 + (config.showphy_pros.width + 10) * i;\n        //     var y = 980;\n        //     var w = config.showphy_pros.width;\n        //     var h = config.showphy_pros.height;\n        //     ctx.roundRect(x,y,w,h,config.showphy_pros.radius);\n        //     ctx.fill();\n        // }\n         for(var starIndex = 0; starIndex < 5; starIndex ++){\n            if(this.point >= starIndex + 1){\n               this.stars[starIndex].node.active = true;\n            }else{\n               this.stars[starIndex].node.active = false;\n            }\n        }\n    },\n    \n    /*\n        调用: 1: 游戏重新开始的时候需要隐藏，2: 游戏结束的时候需要显示\n        功能: gameOver和restart按钮的显示隐藏控制\n        参数: [\n            vis: false: 隐藏元素，true: 显示元素\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    visibleControllButton:function(vis){\n        this.gameOut.node.active = vis;\n    },\n\n    /*\n        调用: 1: 游戏结束的时候需要显示\n        功能: 游戏结束的逻辑\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    gameOverCallBack:function(){\n        // 判断此次得分是否创纪录\n        this.gamestate = config.gameState.gameover;\n        this.visibleControllButton(true);\n        // 刷新当前的显示得分\n        this.loseScoreLabel.string = this.score;\n    },\n\n    /*\n        调用: 1: 刷新当前得分的时候\n        功能: 展示破纪录界面\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    pjlCallBack:function(){\n        // 判断此次得分是否创纪录\n        if(this.score > tywx.Util.getItemFromLocalStorage(\"maxscore\", 0)){\n            this.hadShowPjl = true;\n            this.visibleControllButton(false);\n            this.stopView.active = true;\n            this.pjlView.active = true;\n            // 刷新破纪录的显示\n            this.pjlScoreLabel.string = this.score;\n        }\n    },\n\n\n    /*\n        调用: 点击展示破纪录画面时候的关闭按钮调用\n        功能: 关闭破纪录界面\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    closePjlView:function(){\n        // 判断此次得分是否创纪录\n        this.showStopView();\n        this.pjlView.active = false;\n    },\n\n    /*\n        调用: 1: 游戏开始的时候调用 2: 游戏重新开始的时候调用\n        功能: 游戏初始化\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    initgame:function() {\n        this.score  = 0;\n        this.point  = config.maxphy_value;\n        this.maxnum = config.maxphy_value;\n \n        for (var i = 0; i < config.geziNumber; i++) {\n            var num = this.getrandomnum();\n            this.getAllgz()[i].setnum(num);\n            this.getAllgz()[i].settoblock();\n        }\n\n        var needcheck = true;\n\n        while(needcheck == true) {\n            needcheck = false;\n            for (var i = 0; i < config.geziNumber; i++) {\n                this.resetAllMask();\n                this.checkmaskbyid(i, 0);\n                if (this.g_mask_samecnt >= 3) {\n                    this.changenumbymask();\n                    needcheck = true;\n                }\n            }\n        }\n\n        this.gamestate = config.gameState.waitclick;\n        this.visibleControllButton(false)\n    },\n   \n    /*\n        调用: 1: 游戏处于检查点击的时候调用 2: 游戏开始的时候调用 3: 处理格子连接的时候调用\n        功能: 重置棋盘mask，为重新探路做准备\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要\n    */\n    resetAllMask:function(){\n        for(var i=0;i<config.geziNumber;i++){\n            this.getAllmask()[i].reset();\n        }\n        this.g_mask_samecnt = 1;\n    },\n    \n    \n     /*\n        调用: 1: 处理游戏点击的时候调用 2:游戏格子连接的时候调用\n        功能: 递归寻找给定ID的格子 并在mask数组里面进行标记\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏逻辑需要 通过mask标记来找出每次连接的格子\n    */\n    checkmaskbyid:function(id,step){\n        this.getAllmask()[id].step=step;\n        // 从左找\n        this.checkDirPaths(id, step,0, -1);\n        this.checkDirPaths(id, step,0, -5);\n        this.checkDirPaths(id, step,4, 1);\n        this.checkDirPaths(id, step,4, 5);\n    },\n    \n     /*\n        调用: 1: checkmaskbyid寻找可连的点\n        功能: 检查是否可以继续连接\n        参数: [\n            id: 每个格子的ID\n            step: 此次寻找的步数\n            bj: 寻找边界\n            add: 叠加数 上下加减5 左右加减1\n        ]\n        返回值:[\n           无\n        ]\n        思路: 根据递归寻找下一个点的连接情况\n    */\n    checkDirPaths: function(id, step, bj, add){\n        if(Math.abs(add) == 4 && this.getAllmask()[id] != null && this.getAllmask()[id].y == bj){\n           return false\n        }else if(Math.abs(add) == 1 && this.getAllmask()[id] != null && this.getAllmask()[id].x == bj){\n           return false\n        }\n        if(this.getAllmask()[id] == null || this.getAllmask()[id + add] == null){\n            return false;\n        }\n        if(this.getAllmask()[id + add].num != this.getAllmask()[id].num || this.getAllmask()[id + add].step <= step){\n           return false;\n        }\n\n        if(this.getAllmask()[id + add].step==999){\n            this.g_mask_samecnt++;\n        }\n\n        this.getAllmask()[id + add].step = step;\n        this.getAllmask()[id + add].from = id;\n        this.checkmaskbyid(id + add, step + 1, bj, add)\n    },\n\n\n     /*\n        调用: 游戏初始的时候调用\n        功能: 改变格子的数字 通过mask\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    changenumbymask:function(){\n        for(var i = 0;i < config.geziNumber; i++){\n            if(this.getAllmask()[i].step != 999 && this.getAllmask()[i].step != 0){\n                var num = this.getrandomnum();\n                this.getAllgz()[i].setnum(num);\n                this.getAllgz()[i].settoblock();\n            }\n        }\n    },\n   \n   /*\n        调用: 1, 游戏初始的时候调用 2, 改变格子的数字的时候调用\n        功能: 创建随机的新块 返回新快的显示\n        参数: [\n           无\n        ]\n        返回值:[\n           num: 返回格子的显示数组\n        ]\n        思路: 游戏逻辑需要\n    */\n    getrandomnum:function(){\n        var tnum = this.maxnum - 2;\n        if(tnum<5)\n            tnum = 5;\n\n        var num = parseInt(Math.random() * 10000) % tnum + 1;\n        // if(this.prerandomnumber == num){\n        //     return this.getrandomnum();\n        // }else{\n        //     this.prerandomnumber = num;\n        // }\n        return num;\n    },\n        /*\n        调用: 使用满血道具 或者分享游戏的时候调用\n        功能: 复活游戏\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    recoverGame: function(){\n        if(this.recoverNumber < config.maxrnum){\n            this.point = config.maxphy_value;\n            this.gamestate = config.gameState.waitclick;\n            this.addRecoverNumber();\n            this.visibleControllButton(false);\n        }else{\n            this.showAlert(\"复活次数已达\"+config.maxrnum+\"次，不能继续复活。\")\n            this.initgame();\n        }\n       \n    },\n    \n    /*\n        调用: 游戏处于移动状态的时候调用\n        功能: 创建新的棋盘，为掉落做准备\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    refreshbymask:function(){ \n        for(var i = 0;i < config.geziNumber;i++) {\n            if (this.getAllmask()[i].step != 999 && this.getAllmask()[i].step != 0) {\n                this.getAllmask()[i].from =- 1;\n                var topid = -1;\n                var tmpid = i + 5;\n                while(tmpid < config.geziNumber){\n                    if(this.getAllmask()[tmpid].step == 999 || this.getAllmask()[tmpid].step==0){\n                        topid = tmpid;\n                        break;\n                    }\n                    tmpid += 5;\n                }\n                if(topid != -1){\n                    var dis = this.getAllmask()[topid].y - this.getAllmask()[i].y;\n                    this.getAllgz()[i].block.posx        = this.getAllgz()[topid].posx;\n                    this.getAllgz()[i].block.posy        = this.getAllgz()[topid].posy;\n                    this.getAllgz()[i].block.id_keep     = topid;\n                    this.getAllgz()[i].block.id_dest     = i;\n                    this.getAllgz()[i].block.speed_keep  = (dis * config.gezi_pitch) / config.move_time;\n                    this.getAllgz()[i].block.adjustdrop();\n                    this.getAllgz()[topid].step = 888;\n                    var num = this.getrandomnum();\n                    // this.getAllgz()[i].setnum(this.getAllgz()[topid].num);\n                    this.getAllgz()[i].setnum(num);\n                    this.getAllgz()[i].settoblockvalue();\n                    this.getAllgz()[i].block.effectid       =  this.getAllgz()[topid].block.effectid;\n                    this.getAllgz()[i].block.effecttime     =  this.getAllgz()[topid].block.effecttime;\n                    this.getAllgz()[topid].block.effectid   =- 1;\n                    this.getAllgz()[topid].block.effecttime =  0;\n                }else{\n                    var dis = 5 - this.getAllmask()[i].y;\n                    this.getAllgz()[i].block.posx    = this.getAllgz()[i].posx;\n                    this.getAllgz()[i].block.posy    = this.getAllgz()[i].posy + dis * config.gezi_pitch;\n                    this.getAllgz()[i].block.id_keep = -1;\n                    this.getAllgz()[i].block.id_dest = i;\n                    this.getAllgz()[i].block.speed_keep = (dis * config.gezi_pitch) / config.move_time;\n                    this.getAllgz()[i].block.adjustdrop();\n                    var num = this.getrandomnum();\n                    this.getAllgz()[i].setnum(num);\n                    this.getAllgz()[i].settoblockvalue();\n                }\n            }\n        }\n    },\n    /*\n        调用: 点击返回首页的时候会调用\n        功能: 返回首页\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    backFirstPage:function(){\n        if(tywx.Util.getItemFromLocalStorage(\"maxscore\", 0) < this.score){\n           tywx.Util.setItemToLocalStorage(\"maxscore\",this.score); \n        }\n        if(tywx.publicwx){\n            wx.postMessage({\n                method: 4,\n                score:this.score,\n            });\n        }\n        cc.director.loadScene(\"gamestart\", this.destroyFinish);\n    },\n    \n    backCall:function(){\n    //    this.showMinFriend();\n        this.showAlert(\"测试提示信息\")\n        // this.getAllPathByitemValue({value:2});\n    },\n\n    showMinFriend:function(){\n        var self = this;\n        this.isShowFIcon = true;\n        wx.postMessage({\n            method: 5,\n            score:self.score,\n        });\n    },\n\n    // 刷新子域的纹理\n    _updateSubDomainCanvas: function() {\n            if (!this.tex || !tywx.publicwx) {\n                return;\n            }\n            var openDataContext = wx.getOpenDataContext();\n            var sharedCanvas = openDataContext.canvas;\n            this.tex.initWithElement(sharedCanvas);\n            this.tex.handleLoadedTexture();\n            this.friendIcon.spriteFrame = new cc.SpriteFrame(this.tex);\n     },\n   \n    /*\n        调用: 点击返回首页的时候会调用\n        功能: 清除当前的节点\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    destroyFinish:function(){\n        if(this.node){\n           this.node.destroy();\n        }\n    },\n\n    /*\n        调用: 点击免费领取宝箱的时候调用\n        功能: 领取道具\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    lingQuBox:function(){\n        this.storeAllItem();\n        this.openboxview.active = false;\n        this.showStopView();\n    },\n\n    /*\n        调用: 当条件达到某个值的时候显示领取宝箱\n        功能: 领取道具\n        参数: [\n           无\n        ]\n        返回值:[\n           无\n        ]\n        思路: 游戏逻辑需要\n    */\n    showBox:function(){\n        this.showStopView();\n        this.openboxview.active = true;\n    },\n\n\n    restartGame:function(){\n        this.initgame();\n        this.showSubStopView();\n       \n    }\n\n});\n\n\n\n"]}