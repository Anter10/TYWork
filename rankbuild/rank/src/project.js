__require=function t(e,n,o){function a(s,c){if(!n[s]){if(!e[s]){var r=s.split("/");if(r=r[r.length-1],!e[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+s+"'")}}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){return a(e[s][1][t]||t)},u,u.exports,t,e,n,o)}return n[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<o.length;s++)a(o[s]);return a}({rankitem:[function(t,e,n){"use strict";cc._RF.push(e,"93486w69BJG5rxHNI3FISIF","rankitem"),cc.Class({extends:cc.Component,properties:{pmLabel:cc.Label,imageIcon:cc.Sprite,nickLabel:cc.Label,scoreLabel:cc.Label},updateData:function(t){this.data=t,this.updateView(this.data)},updateView:function(t){console.log("\u66f4\u65b0\u6570\u636e = "+JSON.stringify(t)),this.pmLabel.string=t.pm+1,this.nickLabel.string=t.nickname,this.scoreLabel.string=null==t.KVDataList[0]?0:t.KVDataList[0].value,this.createIcon(this.imageIcon,t.avatarUrl)},createIcon:function(t,e){var n=t;try{var o=wx.createImage();o.src=e,o.onload=function(a){try{var i=new cc.Texture2D;i.initWithElement(o),i.handleLoadedTexture(),n.spriteFrame=new cc.SpriteFrame(i),console.log(e+" ni/ "+t.node.width+" == "+i.width+" "+t.node.y)}catch(t){cc.log("\u56fe\u7247\u52a0\u8f7d\u5931\u8d25")}}}catch(t){}},start:function(){}}),cc._RF.pop()},{}],ranklist:[function(t,e,n){"use strict";cc._RF.push(e,"280c3rsZJJKnZ9RqbALVwtK","ranklist");var o=1,a=2,i=3,s=4;cc.Class({extends:cc.Component,properties:{gameranklist:cc.ScrollView,showloading:cc.Label,rankItem:cc.Prefab,gamerank:cc.Node,content:cc.Node},start:function(){var t=this;wx.onMessage(function(e){t.showloading.node.active=!0,console.log("\u5f53\u524d\u73a9\u5bb6\u7ed9\u5b50\u57df\u7684\u6570\u636e = "+JSON.stringify(e)),e.method==o?t.getFriendData():e.method==a?t.getGroupFriendData(e.shareTicket):e.method==i?t.getUserInfoData():e.method==s&&t.submitScore(e.score)})},submitScore:function(t){var e=this;wx.getUserCloudStorage({keyList:["x1"],success:function(n){console.log("setUserCloudStorage","success",n),e.showloading.node.active=!1,0!=n.KVDataList.length&&n.KVDataList[0].value>t||window.wx.setUserCloudStorage({KVDataList:[{key:"x1",value:""+t}],success:function(t){console.log("setUserCloudStorage","success",t)},fail:function(t){console.log("setUserCloudStorage","fail")},complete:function(t){console.log("setUserCloudStorage","ok")}})},fail:function(t){console.log("getUserCloudStorage","fail")},complete:function(t){console.log("getUserCloudStorage","ok")}})},getUserInfoData:function(){wx.getUserInfo({openIdList:["selfOpenId"],lang:"zh_CN",success:function(t){console.log(JSON.stringify(t));wx.getSharedCanvas().getContext("2d")},fail:function(t){console.log(JSON.stringify(arguments));wx.getSharedCanvas().getContext("2d")}})},getFriendData:function(){var t=this,e=this;wx.getUserInfo({openIdList:["selfOpenId"],success:function(n){t.showloading.node.active=!1,console.log("success"+n.data);n.data[0];wx.getFriendCloudStorage({keyList:["x1"],success:function(n){var o=n.data;console.log("\u5fae\u4fe1\u597d\u53cb\u7684\u6570\u636e = "+JSON.stringify(o)),o.sort(function(t,e){return 0==t.KVDataList.length&&0==e.KVDataList.length?0:0==t.KVDataList.length?1:0==e.KVDataList.length?-1:e.KVDataList[0].value-t.KVDataList[0].value}),e.gameranklist.content.removeAllChildren();for(var a=0;a<o.length;a++){var i=o[a];i.pm=a;var s=cc.instantiate(t.rankItem);s.getComponent("rankitem").updateData(i),s.setPosition(0,-90*a-30),t.gameranklist.content.addChild(s,122)}},fail:function(t){console.log("wx.getFriendCloudStorage fail",t),e.showloading.string="\u6570\u636e\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u68c0\u6d4b\u7f51\u7edc\uff0c\u8c22\u8c22\u3002"}})},fail:function(t){e.showloading.string="\u6570\u636e\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u68c0\u6d4b\u7f51\u7edc\uff0c\u8c22\u8c22\u3002"}})},getGroupFriendData:function(t){var e=this,n=this,o=t;wx.getUserInfo({openIdList:["selfOpenId"],success:function(t){console.log("success",t.data);t.data[0];wx.getGroupCloudStorage({shareTicket:o,keyList:["x1"],success:function(t){console.log("\u7fa4\u7ec4\u6570\u636e = ",t);var o=t.data;o.sort(function(t,e){return 0==t.KVDataList.length&&0==e.KVDataList.length?0:0==t.KVDataList.length?1:0==e.KVDataList.length?-1:e.KVDataList[0].value-t.KVDataList[0].value}),e.showloading.node.active=!1,n.gameranklist.content.removeAllChildren();for(var a=0;a<o.length;a++){var i=o[a];i.pm=a;var s=cc.instantiate(e.rankItem);s.getComponent("rankitem").updateData(i),s.setPosition(0,-90*a-30),e.gameranklist.content.addChild(s,122)}},fail:function(t){console.log("\u5f97\u5230\u7fa4\u7ec4\u6570\u636e\u5931\u8d25",t)}})},fail:function(t){}})}}),cc._RF.pop()},{}]},{},["rankitem","ranklist"]);